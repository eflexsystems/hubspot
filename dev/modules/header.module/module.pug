include ../../components/_cta.pug

//- Pug.js iterations
.
    {%- macro render_link_children(link,depth)-%}
        {%- if link!= [] && link.label -%}
            {%- if link.children -%}
                <div class="col-12 col-lg mb-5 mb-lg-0">
                    <p class="font-weight-bold small text-uppercase border-bottom mx-4 py-3 mb-3">{{link.label}}</p>
                    {%- set depth = depth + 1-%}
                    {%- for sublink in link.children -%}
                        {{render_link_children(sublink,depth)}}
                    {%- endfor -%}
                </div>
            {%- else -%}
                <a class="dropdown-item small text-truncate py-1" href="{{link.url if link.url else '#'}}" aria-role="menuitem">{{link.label}}</a>
            {%- endif -%}
        {%- endif -%}
    {%- endmacro -%}

    {%- macro render_link_item(link,depth)-%}
        {%- if link != [] && link.label -%}

            {%- if link.children -%}
                <li class="nav-item dropdown position-static hs-menu-item hs-menu-depth-{{depth}} hs-item-has-children" aria-role="none">
                    <a class="nav-link dropdown-toggle font-weight-bold py-3 px-md-4" href="#" id="{{link.label.replace(' ', '').toLowerCase()}}Dropdown" role="button" data-toggle="dropdown" aria-haspupup="true" aria-expanded="false">{{link.label}}<i class="fas fa-caret-down fa-sm ml-1"></i></a>
                    <div class="dropdown-menu shadow-sm w-100 rounded-0 pt-0 m-0 hs-menu-item hs-menu-depth-{{depth}}" aria-labelledby="{{link.label.replace(' ', '').toLowerCase()}}Dropdown">
                        <div class="container">
                            <div class="row no-gutters w-100 px-md-4 pb-5">
                                {%- set depth = depth + 1-%}
                                {%- for sublink in link.children -%}
                                    {{render_link_children(sublink,depth)}}
                                {%- endfor -%}
                            </div>
                        </div>
                    </div>
                </li>

            {%- else -%}
                <li class="nav-item hs-menu-item hs-menu-depth-{{depth}} " aria-role="none">
                    <a class="nav-link py-3 px-lg-4" href="{{link.url if link.url else '#'}}" aria-role="menuitem">{{link.label}}</a>
                </li>
            {%- endif -%}
        {%- endif -%}
        
    {%- endmacro -%}

//- Start of Header Structure
#header.fixed-top
    .container
        nav.navbar.navbar-expand-lg.position-static.p-3.px-lg-5.sc-site-header__menu.hs-menu-wrapper.active-branch.flyouts.hs-menu-flow-horizontal(class='sc-site-header__menu--{{ module.menu_field }}' aria-label='{{menu_name}} menu')
            a.navbar-brand.p-3.bg-primary(href='#')
            button.navbar-toggler(type='button' data-toggle='collapse' data-target='#navbarHeader' aria-controls='navbarHeader' aria-expanded='false' aria-label='Toggle navigation')
                span.navbar-toggler-icon
            | {% set menu = menu(module.menu_field , "site_root").children %}
            #navbarHeader.collapse.navbar-collapse
                ul.navbar-nav(aria-role='menubar')
                    | {% for link in menu %}
                    | {{render_link_item(link,1)}}
                    | {% endfor %}
            
                .ml-auto
                    +cta ({
                        name: 'headerCta',
                        guid: 'f8b9429a-a9bd-4e34-a063-f573f8ecbf2d',
                        variant: 'primary',
                        class: 'btn-sm text-capitalize p-2 px-3'
                    })
