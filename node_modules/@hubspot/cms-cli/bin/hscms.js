#!/usr/bin/env node

const { Command } = require('commander');
const updateNotifier = require('update-notifier');

const { addLoggerOptions } = require('../lib/commonOpts');

const { addHelpUsageTracking } = require('../lib/usageTracking');
const pkg = require('../package.json');
const { version } = pkg;

const notifier = updateNotifier({ pkg });

notifier.notify({
  shouldNotifyInNpmScript: true,
});

const program = new Command();

program
  .version(version)
  .description('Tools for working with the HubSpot CMS')
  .command('auth [type]', 'configure authentication with HubSpot')
  .command('upload <src> <dest>', 'upload a file or folder to HubSpot')
  .command('fetch <src> [dest]', 'fetch a file or folder')
  .command('server [src]', 'run the local server', { noHelp: true })
  .command('sync <src> <dest>', 'upload a directory of assets', {
    noHelp: true,
  })
  .command(
    'watch <src> <dest>',
    'watch a folder of assets and upload files when they change'
  )
  .command('create <type> <name> [dest]', 'create an asset')
  .command('remove <path>', 'delete a file or folder from HubSpot')
  .alias('rm');

addLoggerOptions(program);
addHelpUsageTracking(program);

program.parse(process.argv);
